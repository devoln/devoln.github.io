<html>

<head>
<meta charset="utf-8">
<title>Синтезатор MIDI</title>

<script type="text/javascript" src="MusicSynthesizer.js"></script>

<script type="text/javascript">
	var em_module = Module;//require('MusicSynthesizer.js');
	em_module['print'] = function(text)
	{
		if(arguments.length>1) text = Array.prototype.slice.call(arguments).join(' ');
		text = text.replace(/&/g, "&amp;");
		text = text.replace(/</g, "&lt;");
		text = text.replace(/>/g, "&gt;");
		text = text.replace('\n', '<br/>', 'g');
		console.log(text);
		if(output)
		{
			output.innerHTML += text + "<br/>";
			output.scrollTop = output.scrollHeight;
		}
	};
	function PlayMidi()
	{
		var output = document.getElementById('output');
		if(output) output.value = '';
		var url = document.getElementById('midi_url').value;
		var use_streaming = document.getElementById('use_streaming').checked;
		output.innerHTML = '';
		var outPtr = em_module._malloc(url.length*2);
		stringToUTF8(url, outPtr, url.length*2);
		Module._PlayUrl(outPtr, use_streaming);
	}
</script>

</head>

<body>

<h2>Синтезатор MIDI</h2>
<p><b>URL MIDI-файла:</b><br><input type="text" id="midi_url" size="100" value="http://gammaker.github.io/midi/HesaPirate.mid"></p>
<label><input type="checkbox" id="use_streaming">Включить стриминг</label>
<button id="play" onclick="PlayMidi()">Воспроизвести</button>

<hr>
<div id="output"></div>
<hr>

</body>

</html>